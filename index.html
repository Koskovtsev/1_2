<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <script>
        "use strict"
        const csvText =
            `48.30,32.16,Кропивницький,200000,
            44.38, 34.33, Алушта, 31440,
            49.46, 30.17, Біла Церква, 200131,
            49.54, 28.49, Бердичів, 87575, #некоммент

            #
            46.49, 36.58, #Бердянськ, 121692,
            49.15, 28.41, Вінниця, 356665,
            #45.40, 34.29, Джанкой, 43343,

            # в цьому файлі три рядки - коментаря :) `;
        const textToChange = "Я перший раз у місті Кропивницький і другий раз у місті Алушта";
        function csvHandler() {
            let linesArray = csvText.trim().split(`\n`);
            console.log(linesArray.length + " _ " + linesArray);
            let filteredLine = linesArray
                .filter((line) => !(line.trim().startsWith('#') || line.trim() === ""));
            filteredLine.forEach(element => {
                console.log(element.trim());
            });
            let cityesData = filteredLine.map((line) => {
                let elem = line.trim().split(',');
                return {
                    x: +elem[0],
                    y: +elem[1],
                    cityName: elem[2].replace(/[^а-яіїєґ\-\'\’]/gi, ""),
                    cityPopulation: +elem[3]
                }
            });
            console.log(cityesData[4].cityName);
            let top10Cities = cityesData
                .sort((a, b) => a.cityPopulation > b.cityPopulation ? -1 : 1)
                .slice(0, 10);
            let top10CitiesWithRate = top10Cities.reduce((acc, city, index) => {
                name = city.cityName.toLowerCase();
                acc[name] = {
                    population: city.cityPopulation,
                    rate: index + 1
                }
                return acc;
            }, {});
            console.log(top10CitiesWithRate);
            return function (textThatMustBeChanged) {
                let textArray = textThatMustBeChanged.split(' ');
                textArray.filter
                const pattern = new RegExp(top10CitiesWithRate.name, "gi");
                pattern.replace()
                // alert(top10CitiesWithRate[pattern]);
                return textThatMustBeChanged.replace(pattern,
                    /*top10CitiesWithRate.name + */`(... місце в ТОП-10 найбільших міст України, 
                населення ... люд(ина/ини/ей))`);
            }
        }

        alert(csvHandler()(textToChange));


        let text = "hi";
        let heroName = "Jack";
        function sayHi() {
            let myNewMessage = text[0].toUpperCase() + text[1];
            myNewMessage += ", ";
            return (name) => myNewMessage + name + "!";
        }
        alert(sayHi()(heroName));
    </script>
</body>

</html>